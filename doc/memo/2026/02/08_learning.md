# 学習ログ — 2026/02/08

## 本日学んだこと
- JWT ベースのミドルウェア設計：`Authorization: Bearer <token>` を受け取り `auth.Validate` で検証し、`user.id` クレームから DB を照会して `role == "admin"` を確認する流れ。
- テスト戦略：`auth.Validate` をテスト中に差し替える（関数エイリアスを用いる）と、実際のトークン生成を省略して安定した単体テストが書ける。
- モック挙動注意点：`testify/mock` の戻り値インデックスミスはテストパニックの原因になるため、`args.Error(0)` 等の指定が重要。

## 気づき・反省
- ドキュメント更新だけで作業を終える場合でも、次工程（ルート適用→テスト修正）の影響を事前に明確にしておくと手戻りが減る。
