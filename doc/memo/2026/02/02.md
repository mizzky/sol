# 開発メモ - 2026/02/02

## 🎯 本日の作業目的
- **Phase 1（商品・カテゴリ管理）** の実装を進める
- テストコード駆動開発（TDD）で CRUD API を実装

---

## ✅ 完了した作業

### 1. Migration 実行
- `000003_create_categories_table.up.sql`（カテゴリテーブル作成）
- `000004_alter_products_table.up.sql`（商品テーブル拡張）
  - `category_id`, `sku`, `description`, `image_url`, `stock_quantity` などのカラムを追加
  - 外部キー制約とインデックスを設定

### 2. sqlc クエリ定義 & コード生成
- `backend/query.sql` にカテゴリの CRUD クエリを追加：
  - `CreateCategory`（カテゴリ作成）
  - `GetCategory`（カテゴリ取得）
  - `ListCategories`（カテゴリ一覧）
  - `UpdateCategory`（カテゴリ更新）
  - `DeleteCategory`（カテゴリ削除）
- `sqlc generate` を実行し、Go コードを生成成功

### 3. 環境構築のトラブルシューティング
- Dev Container 内での権限エラー解決（`/go` ディレクトリの所有権修正）
- `golang-migrate` のインストールと設定
- PostgreSQL ドライバ（`github.com/lib/pq`）のインストール
- DB 疎通確認完了

---

## 🔄 次のステップ

### 優先度1：テストコード作成
- カテゴリ管理の CRUD API テストを作成
- まずは `POST /categories`（カテゴリ作成）から開始

### 優先度2：ハンドラー実装
- テストが通るようにハンドラーを実装

### 優先度3：商品管理 CRUD API
- カテゴリと同様の手順で商品管理 API を実装

### 優先度4：管理者ミドルウェア
- `AdminOnly()` ミドルウェアを実装し、管理者権限が必要なエンドポイントに適用

---

## 📌 技術的な決定事項

- **Migration 実行方法**: Go スクリプト（`cmd/migrate/main.go`）を使用する案もあったが、最終的に `migrate` CLI で実行
- **開発手法**: テストコード駆動開発（TDD）
- **テスト方針**: HTTPモックを使った単体テスト（推奨）