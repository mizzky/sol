2026-02-13 作業記録

概要
- 目的：商品管理 CRUD を TDD で整備（当面は PUT を全体更新として実装）
- 実施内容：
  - `backend/handler/product.go` に Create/Get/List/Update/Delete ハンドラを実装
  - `backend/handler/product_test.go` に単体テストを追加・拡張（正常系、バリデーション、NotFound 等）
  - `backend/handler/testutil/mockdb.go` に product 系のモックを追加
  - `backend/routes/routes.go` の `/api/products` PUT パスの二重プレフィックス不備を発見、修正案を提示しユーザが適用してテスト通過
  - 学習ログを `doc/memo/2026/02/13_learning.md` に作成

判断・学び
- `UpdateProduct` の SQL は部分更新（COALESCE）を想定しているが、`sqlc` の現状の生成型が非ポインタであるため PATCH 実装は別途設計が必要。短期的には PUT（全体更新）で対応。
- テスト設計は以下が有効：
  - 状態遷移を伴う正常系は単体で順序を追うテストにする
  - バリデーションやエラーケースはテーブル駆動で網羅する
  - `testify/mock` は呼び出し前に `On` を必ず登録する（特にハンドラ先頭で呼ばれる DB メソッド）

結果
- 単体テストは通過済み（`go test ./backend/handler` 等で確認）

次のアクション候補
1. 統合テスト（認可含む）を追加してエンドツーエンド検証
2. `doc/api.md` に PUT（全体更新）仕様とバリデーションを追記
3. PATCH 実装設計（nullable パラメータ化と `sqlc` のクエリ/型設計見直し）を作成

備考
- 本日の進捗は `doc/memo/2026/02/13_learning.md` にも詳細記載済み。
