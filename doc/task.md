## フロント先行ミニマムEC連携（TODO）

### 目的
- ミニマムなEC体験を優先して、フロントとAPIの連携を早期に成立させる。
- 対象: 商品一覧 + 管理者の簡易商品追加 + 簡易ログイン。

### 前提・方針
- API仕様は実装に合わせてdocを整合済み。
- フロントは最小画面: 商品一覧、ログイン、商品追加。
- 認可が必要な操作はJWT（Bearer）を付与する。

### TODO（優先度順）
1. [x] API仕様の整合（レスポンス形式/PUT方針/管理者要約/404追加）
2. [x] フロントのAPI利用設計
   - トークン保持: `localStorage`
   - 状態管理: `zustand`
   - API呼び出し: 小さな fetch util を作成し、認可ヘッダを共通化
   - `GET /api/products` のレスポンス形（`{"products": [...]}`）を反映
   - `POST /api/login` の `token` を保存し、`Authorization: Bearer <token>` で利用
   - `POST /api/products` の必須項目（`name`, `price`, `category_id`, `sku`）を反映
3. [x] 画面設計（最小）
    - 商品一覧
       - 表示項目: `name`, `price`, `category_id`, `sku`
       - 初期表示: `GET /api/products`（レスポンス: `{"products":[...]}`）
       - 表示形式: シンプルなリスト（カード/テーブルは任意）
       - 空表示: 「商品がありません」
       - UI動作: 画面表示時に一覧取得。追加/更新後は再取得またはローカルに即時反映
    - ログイン
       - 入力項目: `email`, `password`
       - 成功時: レスポンスに含まれる `token` を `localStorage.setItem("token", token)` で保存
       - 失敗時: エラーメッセージを表示（バリデーション/認証エラーを分離）
    - 商品追加（管理者のみ）
       - 入力項目: `name`(必須), `price`(必須), `category_id`(必須), `sku`(必須)
       - 認可: リクエストに `Authorization: Bearer <token>` を付与
       - 成功時: 商品一覧を再取得または画面内リストに即時追加して反映
       - 失敗時: `401/403/400/404` に応じたエラーメッセージを表示（`404` はカテゴリ未存在）
4. [x] フロント実装（連携）
   - 商品一覧の取得と表示
   - ログインとトークン保存
   - 商品追加（認可ヘッダ付与）
   - **チケット8完了 (2026-02-19)**: 
     - `useAuthStore` に `login`/`register` 関数を追加
     - `fetchWithAuth` で認証ヘッダの自動付与を実装
     - 401エラー時の自動ログアウトを実装
     - 全テスト (17件) がPASS
5. [ ] 動作確認
   - 未ログイン時の一覧表示
   - ログイン後の商品追加

---
作成日: 2026-02-14
最終更新: 2026-02-19

---

## フロントエンド ページ構成整理（新規追加: 2026-02-19）

### 背景
現在のトップページに一般ユーザー向けの「商品一覧」と管理者向けの「商品登録フォーム」が同居しており、ページ構成が不自然。また、ユーザー登録画面が未実装。

### 目的
- トップページと管理機能を適切に分離
- ユーザー登録画面の実装
- ナビゲーションの実装でUX向上

### TODO（優先度順）
0. [x] **チケット1**: DB スキーマ拡張（reset_token カラム追加） (P0)
   - マイグレーション v5 を執行
   - `000005_add_reset_token_to_users.up.sql` を DB に適用
   - 完了日: 2026-02-19
   - 意義: ユーザー登録機能がDBで正常に動作するための前提条件
   
1. [x] **チケット10**: ユーザー登録画面の実装 (P0)
   - `/register` ページ作成
   - 名前、メール、パスワード入力フォーム
   - `useAuthStore.register()` 連携
   - 登録成功後は `/login` へリダイレクト
   - 完了日: 2026-02-19
   - 影響: `frontend/app/register/page.tsx` (新規)
   
2. [ ] **チケット11**: トップページと管理ページの分離 (P0)
   - 11-1: トップページから商品登録フォームを削除
   - 11-2: `/admin/products` に管理ページ作成
   - 11-3: ヘッダーナビゲーション実装
   - 11-4: 全ページにヘッダー適用
   - 影響: 
     - `frontend/app/page.tsx` (修正)
     - `frontend/app/admin/products/page.tsx` (新規)
     - `frontend/app/components/Header.tsx` (新規)
     - `frontend/app/layout.tsx` (修正)
   
3. [ ] **チケット12**: 管理者権限チェックミドルウェア (P1)
   - `/admin/*` へのアクセス制御
   - 未ログイン → `/login` リダイレクト
   - 非管理者 → `/` リダイレクト
   - 影響: `frontend/app/components/AdminRoute.tsx` (新規)

### あるべきページ構成
```
/                     → 商品一覧（誰でも閲覧可）
/login                → ログイン ✅
/register             → ユーザー登録 ❌
/admin/products       → 商品管理（管理者のみ）❌
```

詳細: [doc/planning/frontend-pages-plan-2026-02-19.md](planning/frontend-pages-plan-2026-02-19.md)

---
追加日: 2026-02-19
